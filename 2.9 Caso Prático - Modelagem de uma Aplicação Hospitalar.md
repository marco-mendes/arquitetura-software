### **Cenário - Plataforma de Evolução de Sistemas Hospitalares da ACME**

O hospital ACME enfrenta desafios significativos de negócio relacionados à fragmentação de sistemas, atrasos na troca de informações entre áreas críticas e dificuldade em manter a continuidade assistencial sem retrabalho ou redundância de dados. Problemas como prescrições não sincronizadas, resultados laboratoriais atrasados e falhas no controle de acesso impactam diretamente a qualidade do atendimento e a segurança do paciente.

Atualmente, o hospital possui 200 leitos ativos, incluindo 50 leitos de UTI e uma média de 1.500 mil atendimentos ambulatoriais por dia e 20.000 exames laboratoriais semanais. Cada médico atende em média 15 pacientes por dia, e a farmácia interna realiza aproximadamente 2.000 prescrições diárias. Durante surtos epidêmicos, a demanda pode aumentar até 80%, pressionando tanto os sistemas administrativos quanto os assistenciais.

Espera-se que a adoção de uma arquitetura moderna permita à TI prover uma base flexível, segura e escalável para digitalizar integralmente os processos clínicos e administrativos, promovendo maior agilidade no cuidado, redução de erros e maior integração com ecossistemas externos.


Um desenho do estado atual é mostrado abaixo.

<img width="391" alt="image" src="https://github.com/user-attachments/assets/19c6e22c-ddfe-4de2-a89f-8113c7bfe1a1" />


---


Você assumiu o papel de arquiteto de software incumbido de desenhar uma solução de backend para esse hospital e o seu primeiro desafio é automatizar a comunicação com o laboratório parceiro, que hoje não existe.

O Hospital ACME já está em uma jornada de modernização, adotando Microsserviços e comunicações REST/JSON. Mas o Laboratório Parceiro é um sistema Monolítico Legado, que exige a comunicação SOAP/XML (padrão TISS) e opera sob alta latência (processamento prolongado). Seu papel é projetar a Interoperabilidade sob estritos requisitos de Segurança (LGPD) e Disponibilidade (99,95%).

1. Estilos de Integração e Acoplamento

Você está decidindo entre o estilo de integração Banco de Dados Compartilhado (BDS) e o estilo API/Serviços (Service-Oriented) para enviar pedidos ao Laboratório.

Pergunta: Do ponto de vista de Evolução de Sistemas  e Continuidade Assistencial, qual o principal risco de adotar o BDS com um sistema legado como o Laboratório?

Justifique usando os termos técnicos Acoplamento Temporal ou Acoplamento Estrutural.

2. Escolha de Protocolo e Trade-offs

O Hospital usa REST/JSON, mas o Laboratório exige SOAP/XML. Você implementará um Gateway de Integração que traduz a comunicação.

Pergunta (Trade-off): O SOAP (com seu contrato WSDL rígido e obrigatório) é mais verboso e lento que o REST. No contexto de auditoria de saúde e regulamentação (TISS), qual é a principal vantagem técnica que o SOAP oferece, apesar da sua verbosidade, em relação ao REST puro?

Dica: Pense em contrato e garantia de formato.

3. Padrão de Design (Anti-Corruption Layer - ACL)

Para proteger os microsserviços modernos do Hospital das complexidades e instabilidades do Laboratório (TISS/SOAP), você decide isolar a lógica de conversão e comunicação.

Pergunta: Qual é o padrão de design arquitetural recomendado para encapsular as complexidades de um sistema legado (como o Laboratório) e apresentar uma interface limpa aos microsserviços do Hospital?

Descreva em poucas palavras qual o papel desse componente na garantia da Consistência dos dados do paciente durante a conversão (JSON $\to$ XML).

4. Asincronismo e Continuidade do Negócio

Devido ao processamento prolongado do Laboratório (latência $> 2$ horas), o Hospital adota o padrão de comunicação Assíncrona.

Pergunta: Qual dos mecanismos assíncronos — Polling (Hospital pergunta repetidamente) ou Webhook/Callback (Laboratório avisa) — é mais eficiente em termos de uso de recursos de rede e latência de notificação?

Discuta o desafio de Segurança (LGPD) do mecanismo Webhook/Callback (Lembre-se: o Hospital expõe um endpoint para o Laboratório externo).

5. Garantia de Entrega e Disponibilidade (99,95%)

Nenhum pedido de exame pode ser perdido, mesmo que o Laboratório caia. Você decide usar uma Fila de Mensagens (Message Queue).

Pergunta: Como essa Fila, em conjunto com o padrão de Processamento Idempotente, mitiga o risco de Duplicidade de pedidos se o Laboratório demorar na resposta e o Hospital tentar enviar a mensagem novamente?

Dica: A Fila garante a entrega. A Idempotência resolve o re-processamento do lado do Consumidor.

6. Modelagem do Fluxo e Consistência Transacional

Desenhe o diagrama de arquitetura do fluxo de Pedido de Exames, focando nos componentes internos do Hospital.

Tarefa: Descreva o fluxo de dados em um parágrafo, incluindo os quatro elementos abaixo:

* Serviço de Prescrição (Microsserviço de origem - REST/JSON).

* Mecanismo de Mensageria (Fila/Tópico).

* Serviço de Integração/ACL (O Tradutor que faz a conversão e usa SOAP/XML).

* Laboratório Externo.

